<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>gustok ‚Äî –∫–æ—Ä–æ—Ç–∫–∏–µ –≤–∏–¥–µ–æ</title>
<meta name="description" content="gustok ‚Äî –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∫–æ—Ä–æ—Ç–∫–∏—Ö –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã—Ö –≤–∏–¥–µ–æ (TikTok-style) –¥–ª—è GitHub Pages." />
<style>
  :root{
    --bg:#0b0b0c;
    --muted: #bfc3c8;
    --accent: #ff3250;
    --glass: rgba(255,255,255,0.06);
    --card-gap: 0;
    font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  }
  *{box-sizing:border-box}
  html,body{
    height:100%;
    margin:0;
    background:linear-gradient(180deg,#050507 0%, #0b0b0c 100%);
    color:white;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
  }

  /* Container: vertical feed with snap */
  .feed {
    height:100vh;
    overflow-y:auto;
    scroll-snap-type: y mandatory;
    -webkit-overflow-scrolling: touch;
  }

  /* Each card is one viewport */
  .card {
    position:relative;
    height:100vh;
    width:100%;
    scroll-snap-align: start;
    display:flex;
    align-items:flex-end;
    justify-content:flex-start;
    background: #000;
  }

  /* Video should cover screen like tiktok */
  .card video{
    position:absolute;
    left:50%;
    top:50%;
    transform: translate(-50%,-50%);
    width:auto;
    height:100vh;
    max-width:none;
    object-fit:cover;
    background:#000;
    z-index:1;
  }

  /* Overlay with info on left */
  .meta {
    position:relative;
    z-index:2;
    padding:20px;
    padding-bottom:40px;
    max-width:65%;
  }
  .meta .user {
    display:flex;
    align-items:center;
    gap:12px;
    margin-bottom:10px;
  }
  .avatar{
    width:48px;height:48px;border-radius:50%;background:linear-gradient(45deg,#ff9a9e,#fad0c4);
    display:inline-block;
    flex:0 0 48px;
  }
  .user .name {font-weight:700}
  .desc{color:var(--muted);margin-top:6px;line-height:1.3;font-size:15px;white-space:pre-wrap;}

  /* Right-side vertical actions */
  .actions {
    position:relative;
    z-index:2;
    margin-left:auto;
    padding:20px;
    padding-bottom:40px;
    display:flex;
    flex-direction:column;
    gap:18px;
    align-items:center;
  }
  .action-btn {
    width:56px;height:56px;border-radius:16px;
    display:flex;align-items:center;justify-content:center;
    background:var(--glass);backdrop-filter: blur(6px);
    border:1px solid rgba(255,255,255,0.04);
    color:white;font-weight:600; cursor:pointer;
  }
  .action-btn .label{display:block;font-size:12px;color:var(--muted);margin-top:6px;text-align:center}
  .action-compact { font-size:13px; }

  /* small ui top */
  .topbar{
    position:fixed;left:0;right:0;top:0;z-index:4;display:flex;align-items:center;justify-content:space-between;padding:10px 16px;
    background:linear-gradient(180deg, rgba(0,0,0,0.35), rgba(0,0,0,0.02));
    border-bottom:1px solid rgba(255,255,255,0.02);
  }
  .logo{font-weight:800;letter-spacing:1px;color:var(--accent)}
  .play-hint{font-size:14px;color:var(--muted)}

  /* comment modal */
  .modal {
    position:fixed;left:0;right:0;bottom:0;z-index:6;background:linear-gradient(180deg,#0b0b0c,#070708);
    border-top-left-radius:12px;border-top-right-radius:12px;padding:12px;box-shadow:0 -20px 40px rgba(0,0,0,0.6);
    transform: translateY(110%); transition: transform 260ms ease;
  }
  .modal.open { transform: translateY(0%); }
  .modal .close { float:right;color:var(--muted);cursor:pointer;font-size:18px }
  .modal .comments { max-height:40vh; overflow:auto; margin-top:8px; color:var(--muted) }
  .modal .add { display:flex; gap:8px; margin-top:10px }
  .modal input { flex:1; padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:white }

  /* responsive */
  @media (min-width:900px){
    .meta{max-width:55%}
    .actions{padding-right:40px}
  }
  @media (max-width:420px){
    .meta{max-width:60%;}
    .avatar{width:44px;height:44px}
    .action-btn{width:50px;height:50px;border-radius:14px}
  }
</style>
</head>
<body>
  <div class="topbar">
    <div class="logo">gustok</div>
    <div class="play-hint">–õ–∏—Å—Ç–∞–π –≤–≤–µ—Ä—Ö ‚Äî —á—Ç–æ–±—ã —Å–º–æ—Ç—Ä–µ—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ ‚ñ∂</div>
  </div>

  <main class="feed" id="feed">
    <!-- –ö–∞—Ä—Ç–æ—á–∫–∏: –∑–∞–º–µ–Ω–∏—Ç–µ src –Ω–∞ —Å–≤–æ–∏ –≤–∏–¥–µ–æ / poster -->
    <article class="card" data-id="1" data-link="https://example.com/video/1">
      <video muted playsinline loop preload="metadata" poster="https://via.placeholder.com/720x1280.png?text=Video+1">
        <!-- –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä–∞–±–æ—á–∏–µ mp4/ webm —Å—Å—ã–ª–∫–∏ -->
        <source src="https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4" type="video/mp4">
        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
      </video>
      <div class="meta">
        <div class="user">
          <div class="avatar" aria-hidden="true"></div>
          <div>
            <div class="name">@user_one ‚Ä¢ <small style="color:var(--muted)">–¥–Ω.–Ω–∞–∑–∞–¥</small></div>
            <div style="font-size:13px;color:var(--muted)">–õ–æ–∫–∞—Ü–∏—è ‚Ä¢ 1.2K –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</div>
          </div>
        </div>
        <div class="desc">–ü–µ—Ä–≤–æ–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –≤–∏–¥–µ–æ. –û–ø–∏—Å–∞–Ω–∏–µ –∏ —Ö–µ—à—Ç–µ–≥–∏ #gustok #demo</div>
      </div>
      <div class="actions" aria-hidden="true">
        <div class="action-btn" data-action="like" title="–ù—Ä–∞–≤–∏—Ç—Å—è">
          <div>
            ‚ù§Ô∏è
            <div class="label action-compact" id="like-1">123</div>
          </div>
        </div>
        <div class="action-btn" data-action="comment" title="–ö–æ–º–º–µ–Ω—Ç—ã">üí¨<div class="label action-compact">–ö–æ–º–º–µ–Ω—Ç</div></div>
        <div class="action-btn" data-action="share" title="–ü–æ–¥–µ–ª–∏—Ç—å—Å—è">üîó<div class="label action-compact">–ü–æ–¥–µ–ª–∏—Ç—Å—è</div></div>
      </div>
    </article>

    <article class="card" data-id="2" data-link="https://example.com/video/2">
      <video muted playsinline loop preload="metadata" poster="https://via.placeholder.com/720x1280.png?text=Video+2">
        <source src="https://samplelib.com/lib/preview/mp4/sample-5s.mp4" type="video/mp4">
        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
      </video>
      <div class="meta">
        <div class="user">
          <div class="avatar" aria-hidden="true" style="background:linear-gradient(45deg,#a18cd1,#fbc2eb)"></div>
          <div>
            <div class="name">@creator_two ‚Ä¢ <small style="color:var(--muted)">6 —á.</small></div>
            <div style="font-size:13px;color:var(--muted)">–ú—É–∑—ã–∫–∞ ‚Ä¢ 9.1K</div>
          </div>
        </div>
        <div class="desc">–ö–æ—Ä–æ—Ç–∫–∞—è –ø–µ—Ç–ª—è 5—Å ‚Äî –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Å–≤–æ—ë –≤–∏–¥–µ–æ</div>
      </div>
      <div class="actions" aria-hidden="true">
        <div class="action-btn" data-action="like">‚ù§Ô∏è<div class="label action-compact" id="like-2">42</div></div>
        <div class="action-btn" data-action="comment">üí¨<div class="label action-compact">–ö–æ–º–º–µ–Ω—Ç</div></div>
        <div class="action-btn" data-action="share">üîó<div class="label action-compact">–ü–æ–¥–µ–ª–∏—Ç—Å—è</div></div>
      </div>
    </article>

    <article class="card" data-id="3" data-link="https://example.com/video/3">
      <video muted playsinline loop preload="metadata" poster="https://via.placeholder.com/720x1280.png?text=Video+3">
        <source src="https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.webm" type="video/webm">
        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
      </video>
      <div class="meta">
        <div class="user">
          <div class="avatar" aria-hidden="true" style="background:linear-gradient(45deg,#ff9a9e,#fecfef)"></div>
          <div>
            <div class="name">@third ‚Ä¢ <small style="color:var(--muted)">1 –¥.</small></div>
            <div style="font-size:13px;color:var(--muted)">–§–æ–Ω–æ–≤–∞—è –º—É–∑—ã–∫–∞ ‚Ä¢ 780</div>
          </div>
        </div>
        <div class="desc">–¢–µ—Å—Ç #3 ‚Äî –ø–æ—Å—Ç–∞–≤—å—Ç–µ —Å–≤–æ–∏ —Å—Å—ã–ª–∫–∏ –Ω–∞ –≤–∏–¥–µ–æ –∏ –ø–æ—Å—Ç–µ—Ä—ã</div>
      </div>
      <div class="actions" aria-hidden="true">
        <div class="action-btn" data-action="like">‚ù§Ô∏è<div class="label action-compact" id="like-3">8</div></div>
        <div class="action-btn" data-action="comment">üí¨<div class="label action-compact">–ö–æ–º–º–µ–Ω—Ç</div></div>
        <div class="action-btn" data-action="share">üîó<div class="label action-compact">–ü–æ–¥–µ–ª–∏—Ç—Å—è</div></div>
      </div>
    </article>

  </main>

  <!-- Comment modal -->
  <div class="modal" id="modal" role="dialog" aria-hidden="true">
    <div style="display:flex;align-items:center;justify-content:space-between">
      <strong>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</strong>
      <span class="close" id="modalClose">‚úñ</span>
    </div>
    <div class="comments" id="commentsList">
      <div style="padding:8px 0;border-bottom:1px solid rgba(255,255,255,0.03)">–ù–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ ‚Äî –±—É–¥—å –ø–µ—Ä–≤—ã–º!</div>
    </div>
    <div class="add">
      <input id="commentInput" placeholder="–ù–∞–ø–∏—Å–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..." />
      <button id="sendComment" class="action-btn" style="min-width:72px">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    </div>
  </div>

<script>
(function(){
  const feed = document.getElementById('feed');
  const cards = Array.from(document.querySelectorAll('.card'));
  const likeCounts = {};
  const modal = document.getElementById('modal');
  const modalClose = document.getElementById('modalClose');
  const commentsList = document.getElementById('commentsList');
  const commentInput = document.getElementById('commentInput');
  const sendComment = document.getElementById('sendComment');
  let activeCardId = null;
  const comments = {}; // simple in-memory store

  // init likeCounts from DOM
  cards.forEach(card=>{
    const id = card.dataset.id;
    const likeEl = document.getElementById('like-'+id);
    likeCounts[id] = parseInt(likeEl?.textContent || '0',10) || 0;
  });

  // IntersectionObserver: play video when card is mostly visible
  const io = new IntersectionObserver(entries=>{
    entries.forEach(entry=>{
      const card = entry.target;
      const video = card.querySelector('video');
      if(entry.isIntersecting && entry.intersectionRatio > 0.6){
        // pause other videos
        document.querySelectorAll('.card video').forEach(v=>{ if(v !== video) { v.pause(); v.currentTime = 0 }});
        video.play().catch(()=>{/* mute required on some browsers */});
        activeCardId = card.dataset.id;
      } else {
        video.pause();
      }
    });
  }, {threshold:[0.25,0.6,0.9]});

  cards.forEach(c=>io.observe(c));

  // actions: like/comment/share
  document.addEventListener('click', async (e)=>{
    const btn = e.target.closest('.action-btn');
    if(!btn) return;
    const card = btn.closest('.card');
    const id = card.dataset.id;
    const action = btn.dataset.action;
    if(action === 'like'){
      likeCounts[id] = (likeCounts[id]||0) + 1;
      const el = document.getElementById('like-'+id);
      if(el) el.textContent = likeCounts[id];
      // simple visual feedback
      btn.animate([{transform:'scale(1)'},{transform:'scale(1.08)'},{transform:'scale(1)'}],{duration:220});
    } else if(action === 'comment'){
      openModal(id);
    } else if(action === 'share'){
      const link = card.dataset.link || location.href + '#video=' + id;
      if(navigator.share){
        try {
          await navigator.share({title:'gustok video', text:'–°–º–æ—Ç—Ä–∏ –≤–∏–¥–µ–æ –≤ gustok', url:link});
        } catch(err){ /* user cancelled */ }
      } else {
        // fallback: copy
        try{
          await navigator.clipboard.writeText(link);
          alert('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞');
        }catch(e){
          prompt('–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—Å—ã–ª–∫—É –≤—Ä—É—á–Ω—É—é:', link);
        }
      }
    }
  });

  // open modal for comments
  function openModal(id){
    activeCardId = id;
    modal.classList.add('open');
    modal.setAttribute('aria-hidden','false');
    renderComments(id);
    // prevent feed scroll behind modal on mobile
    document.body.style.overflow = 'hidden';
  }

  modalClose.addEventListener('click', ()=>{ closeModal(); });
  function closeModal(){
    modal.classList.remove('open');
    modal.setAttribute('aria-hidden','true');
    document.body.style.overflow = '';
  }

  // add comment
  sendComment.addEventListener('click', ()=>{
    const text = commentInput.value.trim();
    if(!text) return;
    const id = activeCardId || '1';
    if(!comments[id]) comments[id] = [];
    comments[id].push({text, at: new Date().toLocaleString()});
    commentInput.value = '';
    renderComments(id);
  });

  function renderComments(id){
    commentsList.innerHTML = '';
    const list = comments[id] || [];
    if(list.length === 0){
      commentsList.innerHTML = '<div style="padding:8px 0;border-bottom:1px solid rgba(255,255,255,0.03)">–ù–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ ‚Äî –±—É–¥—å –ø–µ—Ä–≤—ã–º!</div>';
      return;
    }
    list.slice().reverse().forEach(c=>{
      const d = document.createElement('div');
      d.style.padding = '8px 0';
      d.style.borderBottom = '1px solid rgba(255,255,255,0.03)';
      d.innerHTML = '<strong style="display:block;color:white">–ì–æ—Å—Ç—å</strong><div style="color:var(--muted);font-size:14px;margin-top:4px">'+escapeHtml(c.text)+'</div><div style="color:var(--muted);font-size:12px;margin-top:6px">'+c.at+'</div>';
      commentsList.appendChild(d);
    });
  }

  // escape small
  function escapeHtml(s){ return s.replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;') }

  // Simple keyboard controls: space to pause/play, arrows to navigate
  window.addEventListener('keydown',(e)=>{
    if(e.code === 'Space'){ e.preventDefault(); togglePlayCurrent(); }
    if(e.code === 'ArrowDown'){ feed.scrollBy({top: window.innerHeight, left:0, behavior:'smooth'}); }
    if(e.code === 'ArrowUp'){ feed.scrollBy({top: -window.innerHeight, left:0, behavior:'smooth'}); }
  });

  function togglePlayCurrent(){
    if(!activeCardId) return;
    const card = document.querySelector('.card[data-id="'+activeCardId+'"]');
    const v = card.querySelector('video');
    if(v.paused) v.play(); else v.pause();
  }

  // Mobile: allow swipe quick navigation (touch)
  let touchStartY = 0;
  let touchEndY = 0;
  feed.addEventListener('touchstart', (e)=>{ touchStartY = e.changedTouches[0].clientY; }, {passive:true});
  feed.addEventListener('touchend', (e)=>{
    touchEndY = e.changedTouches[0].clientY;
    const diff = touchStartY - touchEndY;
    if(Math.abs(diff) > 60){
      if(diff > 0) feed.scrollBy({top: window.innerHeight, behavior:'smooth'});
      else feed.scrollBy({top: -window.innerHeight, behavior:'smooth'});
    }
  }, {passive:true});

  // On load, scroll to top & play first visible video
  window.addEventListener('load', ()=>{ window.scrollTo(0,0); /* observer handles play */ });

  // small helper: if a video element is tapped, toggle mute / play
  document.querySelectorAll('.card video').forEach(v=>{
    v.addEventListener('click', ()=>{ if(v.paused) v.play(); else v.pause(); });
    v.addEventListener('dblclick', ()=>{
      // like on double tap
      const card = v.closest('.card');
      const id = card.dataset.id;
      likeCounts[id] = (likeCounts[id]||0) + 1;
      const el = document.getElementById('like-'+id);
      if(el) el.textContent = likeCounts[id];
    });
  });

})();
</script>
</body>
</html>